<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes Sharing App</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body class="container mt-4">
    <h2 class="text-center">Notes Sharing App</h2>

    <!-- Add Note Form -->
    <div class="mb-3">
        <input type="text" id="noteTitle" class="form-control" placeholder="Enter Note Title">
        <textarea id="noteContent" class="form-control mt-2" rows="4" placeholder="Enter Note Content"></textarea>
        <button class="btn btn-success mt-2" onclick="shareNote()">Share Note</button>
    </div>

    <!-- Notes List -->
    <h3>All Notes</h3>
    <ul id="notesList" class="list-group"></ul>

    <script>
        // Fetch all notes
        function loadNotes() {
            $.get("/notes", function(data) {
                $("#notesList").empty();
                data.forEach(note => {
                    $("#notesList").append(`
                        <li class="list-group-item">
                            <h5>${note.title}</h5>
                            <p>${note.content}</p>
                            <button class="btn btn-warning btn-sm" onclick="editNote(${note.id}, '${note.content}')">Edit</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteNote(${note.id})">Delete</button>
                        </li>
                    `);
                });
            });
        }

        // Share a new note
        function shareNote() {
            const title = $("#noteTitle").val();
            const content = $("#noteContent").val();
            if (!title || !content) {
                alert("Title and content cannot be empty!");
                return;
            }
            $.post("/share", JSON.stringify({ title, content }), function() {
                loadNotes();
                $("#noteTitle").val("");
                $("#noteContent").val("");
            }, "json");
        }

        // Edit an existing note
        function editNote(id, oldContent) {
            const newContent = prompt("Update Note:", oldContent);
            if (newContent !== null) {
                $.ajax({
                    url: `/update/${id}`,
                    type: "PUT",
                    contentType: "application/json",
                    data: JSON.stringify({ content: newContent }),
                    success: function() {
                        loadNotes();
                    }
                });
            }
        }

        // Delete a note
        function deleteNote(id) {
            if (confirm("Are you sure you want to delete this note?")) {
                $.ajax({
                    url: `/delete/${id}`,
                    type: "DELETE",
                    success: function() {
                        loadNotes();
                    }
                });
            }
        }

        // Load notes on page load
        $(document).ready(loadNotes);
    </script>
</body>
</html>
